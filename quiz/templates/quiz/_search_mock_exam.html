<!-- âœ… æ¡Œæ©Ÿç‰ˆï¼ˆå›ºå®šå³ä¸Šï¼‰ -->
<div class="fixed-search-bar collapsed" id="searchBar">
  <button class="toggle-btn btn btn-sm btn-outline-primary" onclick="toggleSearchBar()">
    <span id="toggleIcon">â–¼</span> æœå°‹é¡Œç›®
  </button>

  <form method="get" action="{% url 'mock_exam' %}" class="row g-2 mt-2 px-2">
    <div class="col-6">
      <select name="chapter" id="chapter" class="form-select form-select-sm" onchange="fetchNumbers()">
        <option value="">ç« ç¯€</option>
        {% for ch in chapter_list %}
          <option value="{{ ch }}" {% if category == ch %}selected{% endif %}>{{ ch }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-6">
      <select name="number" id="number" class="form-select form-select-sm">
        <option value="">é¡Œè™Ÿ</option>
        {% for num in number_list %}
          <option value="{{ num }}" {% if number == num %}selected{% endif %}>{{ num }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-12">
      <button type="submit" class="btn btn-sm btn-secondary w-100">æœå°‹</button>
    </div>
  </form>
</div>

<script>
  function fetchNumbers() {
    const chapterSelect = document.getElementById("chapter");
    const selectedChapter = chapterSelect.value;

    fetch(`/get_numbers/?chapter=${selectedChapter}`)
      .then(response => response.json())
      .then(data => {
        const numberSelect = document.getElementById("number");
        numberSelect.innerHTML = '<option value="">é¡Œè™Ÿ</option>';
        data.numbers.forEach(num => {
          const option = document.createElement("option");
          option.value = num;
          option.textContent = num;
          numberSelect.appendChild(option);
        });
      })
      .catch(error => {
        console.error("å–å¾—é¡Œè™Ÿå¤±æ•—ï¼š", error);
      });
  }
</script>

<!-- ğŸ“± æ‰‹æ©Ÿç‰ˆï¼ˆæµ®å‹•æœå°‹æŒ‰éˆ•èˆ‡ä¸‹æ‹‰é¸å–®ï¼‰ -->
<div class="d-md-none">
  <div class="search-fab" onclick="toggleSearchBarMock()">ğŸ”</div>
  <div id="mobileSearchBar-mock" class="mobile-search shadow">
    <form method="get" action="{% url 'mock_exam' %}" class="p-3">
      <div class="mb-2">
        <select name="chapter" id="chapter_mobile" class="form-select form-select-sm" onchange="fetchNumbersMobile()">
          <option value="">ç« ç¯€</option>
          {% for ch in chapter_list %}
            <option value="{{ ch }}" {% if category == ch %}selected{% endif %}>{{ ch }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-2">
        <select name="number" id="number_mobile" class="form-select form-select-sm">
          <option value="">é¡Œè™Ÿ</option>
          {% for num in number_list %}
            <option value="{{ num }}" {% if number == num %}selected{% endif %}>{{ num }}</option>
          {% endfor %}
        </select>
      </div>

      <button type="submit" class="btn btn-sm btn-secondary w-100">æœå°‹</button>
    </form>
  </div>
</div>